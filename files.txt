bankple/
â”‚
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ bankple/             # main entry point
â”‚       â””â”€â”€ main.go
â”‚
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ api/                 # HTTP handlers
â”‚   â”‚   â”œâ”€â”€ account.go
â”‚   â”‚   â”œâ”€â”€ transfer.go
â”‚   â”‚   â””â”€â”€ middleware.go
â”‚   â”‚
â”‚   â”œâ”€â”€ db/                  # Database access (store layer)
â”‚   â”‚   â”œâ”€â”€ postgres.go
â”‚   â”‚   â””â”€â”€ migrations/
â”‚   â”‚       â””â”€â”€ 001_init.sql
â”‚   â”‚
â”‚   â”œâ”€â”€ service/             # Business logic layer
â”‚   â”‚   â”œâ”€â”€ account.go
â”‚   â”‚   â””â”€â”€ transfer.go
â”‚   â”‚
â”‚   â”œâ”€â”€ auth/                # JWT handling, token creation/validation
â”‚   â”‚   â””â”€â”€ jwt.go
â”‚   â”‚
â”‚   â””â”€â”€ models/              # Shared domain types across layers
â”‚       â”œâ”€â”€ account.go       # Account struct, request/response types
â”‚       â”œâ”€â”€ transfer.go      # Transfer request struct, etc.
â”‚       â””â”€â”€ auth.go          # User, Claims, LoginRequest etc.
â”‚
â”œâ”€â”€ pkg/                     # Public reusable packages (if any)
â”‚   â””â”€â”€ utils/               # Shared helpers (e.g., JSON writer, logger)
â”‚       â””â”€â”€ response.go
â”‚
â”œâ”€â”€ config/                  # App configuration (env, constants)
â”‚   â””â”€â”€ config.go
â”‚
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â”œâ”€â”€ Makefile                 # Build/run commands
â””â”€â”€ README.md












[1] ğŸŒ Browser Sends HTTP Request (e.g., POST /account)
    - Example: curl -X POST http://localhost:8080/account
           |
           v
[2] ğŸš€ main.go: Start Server and Inject Dependencies
    â””â”€â”€ File: cmd/bankple/main.go
    â””â”€â”€ Requires:
        âœ… DB store (e.g., NewPostgresStore)
        âœ… router.NewRouter(store)
    â””â”€â”€ Action:
        - Initialize DB connection
        - Construct and inject shared dependencies
        - Start HTTP server: http.ListenAndServe(":8080", router)
           |
           v
[3] ğŸ§­ router.go: Central Router Setup
    â””â”€â”€ File: internal/router/router.go
    â””â”€â”€ Requires:
        âœ… Feature-specific routers (account_router.go, etc.)
    â””â”€â”€ Action:
        - Create router via mux.NewRouter()
        - Call RegisterAccountRoutes(r, store)
        - Return the fully configured router
           |
           v
[4] ğŸ”Œ account_router.go: Register Account Routes
    â””â”€â”€ File: internal/router/account_router.go
    â””â”€â”€ Requires:
        âœ… store to initialize service
        âœ… service to initialize handler
    â””â”€â”€ Action:
        - Initialize AccountService with DB store
        - Initialize AccountHandler with service
        - Bind handler to route:
            r.HandleFunc("/account", handler.HandleAccount).Methods("POST")
           |
           v
[5] ğŸ§° account.go (Handler Layer)
    â””â”€â”€ File: internal/api/account.go
    â””â”€â”€ Requires:
        âœ… AccountService
    â””â”€â”€ Action:
        - Parse and validate request input
        - Call business logic: service.CreateAccount()
        - Encode and send response
           |
           v
[6] ğŸ§  account.go (Service Layer)
    â””â”€â”€ File: internal/service/account.go
    â””â”€â”€ Requires:
        âœ… Database store interface (Storage)
    â””â”€â”€ Action:
        - Implement business rules (e.g., check duplicates, etc.)
        - Call DB store: store.CreateAccount(...)
        - Return result or error
           |
           v
[7] ğŸ—ƒï¸ postgres.go (DB Layer)
    â””â”€â”€ File: internal/db/postgres.go
    â””â”€â”€ Requires:
        âœ… Active DB connection (e.g., *sql.DB)
    â””â”€â”€ Action:
        - Prepare and execute SQL queries (INSERT, SELECT, etc.)
        - Scan DB results into Go structs
        - Return data to service layer
           |
           v
[8] ğŸ” Response Bubbles Back Up (DB â†’ Service â†’ Handler â†’ Router â†’ Server)
    â””â”€â”€ Each layer passes response/error upward
           |
           v
[9] ğŸ“¤ Final Response Sent to Browser
    â””â”€â”€ In handler:
        âœ… json.NewEncoder(w).Encode(response)
        âœ… Status codes (e.g., w.WriteHeader(201))
